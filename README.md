# RapidOCR-json å›¾ç‰‡è½¬æ–‡å­—ç¨‹åº

è¿™æ˜¯ä¸€ä¸ªåŸºäº [RapidOcrOnnx](https://github.com/RapidAI/RapidOcrOnnx) çš„ç¦»çº¿å›¾ç‰‡OCRæ–‡å­—è¯†åˆ«ç¨‹åºã€‚é€šè¿‡ç®¡é“ç­‰æ–¹å¼è¾“å…¥æœ¬åœ°å›¾ç‰‡è·¯å¾„ï¼Œè¾“å‡ºè¯†åˆ«ç»“æœjsonå­—ç¬¦ä¸²ã€‚é€‚ç”¨äº `Win7 x64` åŠä»¥ä¸Šçš„ç³»ç»Ÿã€‚

![](/readme_images/img-1.png)

### å†™åœ¨å‰é¢

æœ¬é¡¹ç›®æ˜¯ [PaddleOCR-json](https://github.com/hiroi-sora/PaddleOCR-json) çš„å§å¦¹é¡¹ç›®ï¼Œéƒ½æ˜¯æ—¨åœ¨æä¾›ä¸€ä¸ªå¯¹ç°æœ‰OCRå¼•æ“ï¼ˆRapidOCRã€PaddleOCRï¼‰çš„å°è£…ï¼Œä½¿å¾—æ²¡æœ‰C++ç¼–ç¨‹åŸºç¡€çš„ç”¨æˆ·ä¹Ÿå¯ä»¥ç”¨åˆ«çš„è¯­è¨€æ¥ç®€å•åœ°è°ƒç”¨OCRï¼Œäº«å—åˆ°æ›´å¿«çš„è¿è¡Œæ•ˆç‡å’Œæ›´ä¾¿æ·çš„æ‰“åŒ…&éƒ¨ç½²æ‰‹æ®µã€‚

## å·®å¼‚

RapidOCR-json ä¸ PaddleOCR-json æ— è®ºä½¿ç”¨ä¸Šè¿˜æ˜¯åŠŸèƒ½ä¸Šéƒ½æä¸ºç›¸ä¼¼ï¼Œä½ å¯ä»¥åœ¨é¡¹ç›®ä¸­æ–¹ä¾¿çš„åˆ‡æ¢è¿™ä¸¤ä¸ªå¼•æ“ç»„ä»¶ã€‚ä¸‹è¡¨è¯´æ˜äº†å®ƒä»¬ä¹‹é—´çš„å·®å¼‚ã€‚ï¼ˆâ€œğŸ‘â€è¡¨ç¤ºæ­¤é¡¹æ˜¾è‘—ä¼˜äºå¯¹æ–¹ï¼‰

|                    | PaddleOCR-json                           | RapidOCR-json  |
| ------------------ | ---------------------------------------- | -------------- |
| æœ€ä½æ”¯æŒç³»ç»Ÿ       | Win10                                    | Win7 ğŸ‘         |
| mkldnnåŠ é€Ÿæ¨ç†     | æ”¯æŒ                                     | æ—              |
| è¯†åˆ«æ—¶é—´ï¼ˆç›¸å¯¹å€¼ï¼‰ | 100%ï¼Œå¿«ï¼ˆå¯ç”¨mkldnnåŠ é€Ÿï¼‰ğŸ‘              | 200%ï¼Œæ…¢       |
|                    | 400%ï¼Œææ…¢ï¼ˆä¸å¯ç”¨mkldnnï¼‰               |                |
| åˆå§‹åŒ–è€—æ—¶         | çº¦2sï¼Œæ…¢                                 | 0.1så†…ï¼Œå¿« ğŸ‘   |
| æ”¯æŒè¯­è¨€           | å·²æ•´ç†å¥½`ç®€,ç¹,è‹±,æ—¥,éŸ©,ä¿„,å¾·,æ³•`è¯†åˆ«åº“ğŸ‘ | éœ€è‡ªå·±è½¬æ¢æ¨¡å‹ |
| ä½“ç§¯ï¼ˆå‹ç¼©ï¼‰       | 52MB                                     | 15MB ğŸ‘         |
| ä½“ç§¯ï¼ˆéƒ¨ç½²ï¼‰       | 250MB                                    | 30MB ğŸ‘         |
| å†…å­˜å ç”¨å³°å€¼       | >2000MBï¼ˆå¯ç”¨mkldnnï¼‰                    | ~500MB ğŸ‘       |
|                    | ~600MBï¼ˆä¸å¯ç”¨mkldnnï¼‰                   |                |

- è‹¥è¿½æ±‚è¯†åˆ«é€Ÿåº¦ä¼˜å…ˆä¸”ç¡¬ä»¶æ€§èƒ½è¾ƒå¼ºï¼Œæ¨èPaddleã€‚
- è‹¥éœ€å¤šå›½è¯­è¨€è¯†åˆ«ï¼Œæ¨èPaddleã€‚
- è‹¥å¯ç”¨å†…å­˜è¾ƒå°‘æˆ–ç¡¬ä»¶æ€§èƒ½è¾ƒå·®ï¼Œæ¨èRapidã€‚
- è‹¥éœ€å…¼å®¹win7ï¼Œåªèƒ½é€‰æ‹©Rapidã€‚

## å‡†å¤‡å·¥ä½œ

ä¸‹è½½ [RapidOCR-json v0.2.0](https://github.com/hiroi-sora/RapidOCR-json/releases/tag/v0.2.0) å¹¶è§£å‹ï¼Œå³å¯ã€‚

### ç®€å•è¯•ç”¨

æ–¹å¼ä¸€ï¼š

æ‰“å¼€æ§åˆ¶å°ï¼Œè¾“å…¥ `path/RapidOCR-json.exe --image_path=path/test1.png` ã€‚

æ–¹å¼äºŒï¼š

ç›´æ¥åŒå‡»æ‰“å¼€ `RapidOCR_json.exe` ã€‚ç­‰ç¨‹åºåˆå§‹åŒ–å®Œæ¯•è¾“å‡º`OCR init completed.`ã€‚

ä½¿ç”¨jsonå­—ç¬¦ä¸²è¾“å…¥å›¾ç‰‡è·¯å¾„ï¼Œå»ºè®®ä½¿ç”¨asciiè½¬ä¹‰ã€‚å¦‚ï¼š

`{"image_path":"D:/\u6d4b\u8bd5\u56fe\u7247.png"}`

ä¹Ÿæ”¯æŒä¼ å…¥å›¾ç‰‡base64ç¼–ç çš„å­—ç¬¦ä¸²ã€‚å¦‚ï¼š

`{"image_base64":"â€¦â€¦"}`

è¿˜å¯ä»¥ç›´æ¥ä½¿ç”¨ [Python API](api/python/) ã€‚


## æŒ‡ä»¤è¯´æ˜

| é”®åç§°         | å€¼è¯´æ˜                               | é»˜è®¤å€¼                                |
| -------------- | ------------------------------------ | ------------------------------------- |
| ensureAscii    | å¯ç”¨(1)/ç¦ç”¨(0) ASCIIè½¬ä¹‰è¾“å‡º        | 0                                     |
| models         | æ¨¡å‹ç›®å½•åœ°å€ï¼Œå¯ç»å¯¹orç›¸å¯¹è·¯å¾„       | "models"                              |
| det            | detåº“åç§°                            | "ch_PP-OCRv3_det_infer.onnx"          |
| cls            | clsåº“åç§°                            | "ch_ppocr_mobile_v2.0_cls_infer.onnx" |
| rec            | recåº“åç§°                            | "ch_PP-OCRv3_rec_infer.onnx"          |
| keys           | recå­—å…¸åç§°                          | "ppocr_keys_v1.txt"                   |
| doAngle        | å¯ç”¨(1)/ç¦ç”¨(0) æ–‡å­—æ–¹å‘æ£€æµ‹         | 1                                     |
| mostAngle      | å¯ç”¨(1)/ç¦ç”¨(0) è§’åº¦æŠ•ç¥¨             | 1                                     |
| numThread      | çº¿ç¨‹æ•°                               | 4                                     |
| padding        | é¢„å¤„ç†ç™½è¾¹å®½åº¦ï¼Œå¯ä¼˜åŒ–çª„è¾¹å›¾ç‰‡è¯†åˆ«ç‡ | 50                                    |
| maxSideLen     | å›¾ç‰‡é•¿è¾¹ç¼©å°å€¼ï¼Œå¯æé«˜å¤§å›¾é€Ÿåº¦       | 1024                                  |
| boxScoreThresh | æ–‡å­—æ¡†ç½®ä¿¡åº¦é—¨é™å€¼                   | 0.5                                   |
| boxThresh      |                                      | 0.3                                   |
| unClipRatio    | å•ä¸ªæ–‡å­—æ¡†å¤§å°å€ç‡                   | 1.6                                   |
| image_path     | åˆå§‹å›¾ç‰‡è·¯å¾„                         | ""                                    |


ä¾‹1ï¼šï¼ˆå¯åŠ¨æ—¶ä¼ å…¥å›¾ç‰‡è·¯å¾„ï¼Œæ‰§è¡Œä¸€æ¬¡è¯†åˆ«ï¼Œç„¶åå…³é—­ç¨‹åºï¼‰
```
RapidOCR_json.exe  --image_path="D:/images/test(1).png"
è¾“å‡º: è¯†åˆ«ç»“æœ
```

ä¾‹2ï¼šï¼ˆå¯åŠ¨æ—¶ä¸ä¼ å…¥å›¾ç‰‡è·¯å¾„ï¼Œè¿›å…¥æ— é™å¾ªç¯ï¼Œä¸æ–­æ¥å—jsonè¾“å…¥ï¼‰
```
RapidOCR_json.exe  --ensureAscii=1
è¾“å‡º: OCR init completed.
{"image_path": "D:/images/test(1).png"}
è¾“å‡º: è¯†åˆ«ç»“æœ
```

ä¾‹3ï¼šï¼ˆæ‰‹åŠ¨æŒ‡å®šå‚æ•°ï¼‰
```
RapidOCR_json.exe --doAngle=0 --mostAngle=0 --numThread=12 --padding=100 --image_path="D:/images/test(1).png"
```


## è¿”å›å€¼è¯´æ˜

é€šè¿‡APIè°ƒç”¨ä¸€æ¬¡OCRï¼Œæ— è®ºæˆåŠŸä¸å¦ï¼Œéƒ½ä¼šè¿”å›ä¸€ä¸ªå­—å…¸ã€‚

å­—å…¸ä¸­ï¼Œæ ¹å«ä¸¤ä¸ªå…ƒç´ ï¼šçŠ¶æ€ç `code`å’Œå†…å®¹`data`ã€‚

çŠ¶æ€ç `code`ä¸ºæ•´æ•°ï¼Œæ¯ç§çŠ¶æ€ç å¯¹åº”ä¸€ç§æƒ…å†µï¼š

##### `100` è¯†åˆ«åˆ°æ–‡å­—

- dataå†…å®¹ä¸ºæ•°ç»„ã€‚æ•°ç»„æ¯ä¸€é¡¹ä¸ºå­—å…¸ï¼Œå«ä¸‰ä¸ªå…ƒç´ ï¼š
  - `text` ï¼šæ–‡æœ¬å†…å®¹ï¼Œå­—ç¬¦ä¸²ã€‚
  - `box` ï¼šæ–‡æœ¬åŒ…å›´ç›’ï¼Œé•¿åº¦ä¸º4çš„æ•°ç»„ï¼Œåˆ†åˆ«ä¸ºå·¦ä¸Šè§’ã€å³ä¸Šè§’ã€å³ä¸‹è§’ã€å·¦ä¸‹è§’çš„`[x,y]`ã€‚æ•´æ•°ã€‚
  - `score` ï¼šè¯†åˆ«ç½®ä¿¡åº¦ï¼Œæµ®ç‚¹æ•°ã€‚
- ä¾‹ï¼š
  ```
    {'code':100,'data':[{'box':[[13,5],[161,5],[161,27],[13,27]],'score':0.9996442794799805,'text':'é£èˆçš„å› æœäº¤æµ'}]}
  ```

##### `101` æœªè¯†åˆ«åˆ°æ–‡å­—

- dataä¸ºå­—ç¬¦ä¸²ï¼š`No text found in image. Path:"å›¾ç‰‡è·¯å¾„"`
- ä¾‹ï¼š```{'code':101,'data':'No text found in image. Path: "D:\\ç©ºç™½.png"'}```
- è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œè¯†åˆ«æ²¡æœ‰æ–‡å­—çš„ç©ºç™½å›¾ç‰‡æ—¶ä¼šå‡ºç°è¿™ç§ç»“æœã€‚

##### `200` å›¾ç‰‡è·¯å¾„ä¸å­˜åœ¨

- dataä¸ºå­—ç¬¦ä¸²ï¼š`Image path dose not exist. Path:"å›¾ç‰‡è·¯å¾„".`
- ä¾‹ï¼š`{'code':200,'data':'Image path dose not exist. Path: "D:\\ä¸å­˜åœ¨.png"'}`
- æ³¨æ„ï¼Œåœ¨ç³»ç»Ÿæœªå¼€å¯utf-8æ”¯æŒï¼ˆ`ä½¿ç”¨ Unicode UTF-8 æä¾›å…¨çƒè¯­è¨€æ”¯æŒ"`ï¼‰æ—¶ï¼Œä¸èƒ½è¯»å…¥å«emojiç­‰ç‰¹æ®Šå­—ç¬¦çš„è·¯å¾„ï¼ˆå¦‚`ğŸ˜€.png`ï¼‰ã€‚ä½†ä¸€èˆ¬çš„ä¸­æ–‡åŠå…¶ä»– Unicode å­—ç¬¦è·¯å¾„æ˜¯æ²¡é—®é¢˜çš„ï¼Œä¸å—ç³»ç»ŸåŒºåŸŸåŠé»˜è®¤ç¼–ç å½±å“ã€‚

##### `201` å›¾ç‰‡è·¯å¾„stringæ— æ³•è½¬æ¢åˆ°wstring

- dataä¸ºå­—ç¬¦ä¸²ï¼š`Image path failed to convert to utf-16 wstring. Path: "å›¾ç‰‡è·¯å¾„".`
- ä½¿ç”¨APIæ—¶ï¼Œç†è®ºä¸Šä¸ä¼šæŠ¥è¿™ä¸ªé”™ã€‚
- å¼€å‘APIæ—¶ï¼Œè‹¥ä¼ å…¥å­—ç¬¦ä¸²çš„ç¼–ç ä¸åˆæ³•ï¼Œæœ‰å¯èƒ½æŠ¥è¿™ä¸ªé”™ã€‚

##### `202` å›¾ç‰‡è·¯å¾„å­˜åœ¨ï¼Œä½†æ— æ³•æ‰“å¼€æ–‡ä»¶

- dataä¸ºå­—ç¬¦ä¸²ï¼š`Image open failed. Path: "å›¾ç‰‡è·¯å¾„".`
- å¯èƒ½ç”±ç³»ç»Ÿæƒé™ç­‰åŸå› å¼•èµ·ã€‚

##### `203` å›¾ç‰‡æ‰“å¼€æˆåŠŸï¼Œä½†è¯»å–åˆ°çš„å†…å®¹æ— æ³•è¢«opencvè§£ç 

- dataä¸ºå­—ç¬¦ä¸²ï¼š`Image decode failed. Path: "å›¾ç‰‡è·¯å¾„".`
- æ³¨æ„ï¼Œå¼•æ“ä¸ä»¥æ–‡ä»¶åç¼€æ¥åŒºåˆ†å„ç§å›¾ç‰‡ï¼Œè€Œæ˜¯å¯¹å­˜åœ¨çš„è·¯å¾„ï¼Œå‡è¯»å…¥å­—èŠ‚å°è¯•è§£ç ã€‚è‹¥ä¼ å…¥çš„æ–‡ä»¶è·¯å¾„ä¸æ˜¯å›¾ç‰‡ï¼Œæˆ–å›¾ç‰‡å·²æŸåï¼Œåˆ™ä¼šæŠ¥è¿™ä¸ªé”™ã€‚
- åä¹‹ï¼Œå°†æ­£å¸¸å›¾ç‰‡çš„åç¼€æ”¹ä¸ºåˆ«çš„ï¼ˆå¦‚`.png`æ”¹æˆ`.jpgæˆ–.exe`ï¼‰ï¼Œä¹Ÿå¯ä»¥è¢«æ­£å¸¸è¯†åˆ«ã€‚

##### `210` å‰ªè´´æ¿æ‰“å¼€å¤±è´¥

- dataä¸ºå­—ç¬¦ä¸²ï¼š`Clipboard open failed.`
- å¯èƒ½ç”±åˆ«çš„ç¨‹åºæ­£åœ¨å ç”¨å‰ªè´´æ¿ç­‰åŸå› å¼•èµ·ã€‚

##### `211` å‰ªè´´æ¿ä¸ºç©º

- dataä¸ºå­—ç¬¦ä¸²ï¼š`Clipboard is empty.`

##### `212` å‰ªè´´æ¿çš„æ ¼å¼ä¸æ”¯æŒ

- dataä¸ºå­—ç¬¦ä¸²ï¼š`Clipboard format is not valid.`
- å¼•æ“åªèƒ½è¯†åˆ«å‰ªè´´æ¿ä¸­çš„ä½å›¾æˆ–æ–‡ä»¶ã€‚è‹¥ä¸æ˜¯è¿™ä¸¤ç§æ ¼å¼ï¼ˆå¦‚å¤åˆ¶äº†ä¸€æ®µæ–‡æœ¬ï¼‰ï¼Œåˆ™ä¼šæŠ¥è¿™ä¸ªé”™ã€‚

##### `213` å‰ªè´´æ¿è·å–å†…å®¹å¥æŸ„å¤±è´¥

- dataä¸ºå­—ç¬¦ä¸²ï¼š`Getting clipboard data handle failed.`
- å¯èƒ½ç”±åˆ«çš„ç¨‹åºæ­£åœ¨å ç”¨å‰ªè´´æ¿ç­‰åŸå› å¼•èµ·ã€‚

##### `214` å‰ªè´´æ¿æŸ¥è¯¢åˆ°çš„æ–‡ä»¶çš„æ•°é‡ä¸ä¸º1

- dataä¸ºå­—ç¬¦ä¸²ï¼š`Clipboard number of query files is not valid. Number: æ–‡ä»¶æ•°é‡`
- åªå…è®¸ä¸€æ¬¡å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶ã€‚ä¸€æ¬¡å¤åˆ¶å¤šä¸ªæ–‡ä»¶å†è°ƒç”¨OCRä¼šå¾—åˆ°æ­¤æŠ¥é”™ã€‚

##### `215` å‰ªè´´æ¿æ£€ç´¢å›¾å½¢å¯¹è±¡ä¿¡æ¯å¤±è´¥

- dataä¸ºå­—ç¬¦ä¸²ï¼š`Clipboard get bitmap object failed.`
- å‰ªè´´æ¿ä¸­æ˜¯ä½å›¾ï¼Œä½†è·å–ä½å›¾ä¿¡æ¯å¤±è´¥ã€‚å¯èƒ½ç”±åˆ«çš„ç¨‹åºæ­£åœ¨å ç”¨å‰ªè´´æ¿ç­‰åŸå› å¼•èµ·ã€‚

##### `216` å‰ªè´´æ¿è·å–ä½å›¾æ•°æ®å¤±è´¥

- dataä¸ºå­—ç¬¦ä¸²ï¼š`Getting clipboard bitmap bits failed.`
- å‰ªè´´æ¿ä¸­æ˜¯ä½å›¾ï¼Œè·å–ä½å›¾ä¿¡æ¯æˆåŠŸï¼Œä½†è¯»å…¥ç¼“å†²åŒºå¤±è´¥ã€‚å¯èƒ½ç”±åˆ«çš„ç¨‹åºæ­£åœ¨å ç”¨å‰ªè´´æ¿ç­‰åŸå› å¼•èµ·ã€‚

##### `217` å‰ªè´´æ¿ä¸­ä½å›¾çš„é€šé“æ•°ä¸æ”¯æŒ

- dataä¸ºå­—ç¬¦ä¸²ï¼š`Clipboard number of image channels is not valid. Number: é€šé“æ•°`
- å¼•æ“åªå…è®¸è¯»å…¥é€šé“ä¸º1ï¼ˆé»‘ç™½ï¼‰ã€3ï¼ˆRGBï¼‰ã€4ï¼ˆRGBAï¼‰çš„å›¾ç‰‡ã€‚ä½å›¾é€šé“æ•°ä¸æ˜¯1ã€3æˆ–4ï¼Œä¼šæŠ¥è¿™ä¸ªé”™ã€‚

##### `299` æœªçŸ¥å¼‚å¸¸

- dataä¸ºå­—ç¬¦ä¸²ï¼š`An unknown error has occurred.`
- æ­£å¸¸æƒ…å†µä¸‹ä¸åº”è¯¥å‡ºç°æ­¤çŠ¶æ€ç ã€‚è¯·æissueã€‚

##### `300` è¿”å›æ•°æ®æ— æ³•è½¬æ¢ä¸ºjsonå­—ç¬¦ä¸²

- dataä¸ºå­—ç¬¦ä¸²ï¼š`JSON dump failed. Coding error.`
- é€šè¿‡å¯åŠ¨å‚æ•°-image_dirä¼ å…¥éæ³•ç¼–ç çš„è·¯å¾„ï¼ˆå«ä¸­æ–‡ï¼‰æ—¶å¼•èµ·ã€‚ï¼ˆä¸­æ–‡è·¯å¾„åº”è¯¥å…ˆå¯åŠ¨ç¨‹åºå†è¾“å…¥ï¼‰


## é€šè¿‡APIè°ƒç”¨

### 1. Python API

[èµ„æºç›®å½•](api/python)

ä½¿ç”¨ç¤ºä¾‹ï¼š
```python
import os
import sys

from RapidOCR_api import OcrAPI

ocrPath = 'å¼•æ“è·¯å¾„/RapidOCR_json.exe'
ocr = OcrAPI(ocrPath)
res = ocr.run('æ ·ä¾‹.png')

print('OCRè¯†åˆ«ç»“æœï¼š\n', res)
ocr.stop()
```

å…¶ä»–å¾…å¡«å‘â€¦â€¦


## [é¡¹ç›®æ„å»ºæŒ‡å—](cpp)
ğŸ‘†å½“ä½ éœ€è¦ä¿®æ”¹é¡¹ç›®æºç æ—¶æ¬¢è¿å‚è€ƒã€‚

## æ„Ÿè°¢

æ„Ÿè°¢ [RapidAI/RapidOcrOnnx](https://github.com/RapidAI/RapidOcrOnnx) ï¼Œæ²¡æœ‰å®ƒå°±æ²¡æœ‰æœ¬é¡¹ç›®ã€‚

æœ¬é¡¹ç›®ä¸­ä½¿ç”¨äº† [nlohmann/json](https://github.com/nlohmann/json) ï¼š
> â€œJSON for Modern C++â€

## æ›´æ–°æ—¥å¿—

#### v0.2.0 `2023.9.25` 
- è·¯å¾„è¯†å›¾çš„keyç”± `imagePath` æ”¹ä¸º `image_path`
- æ–°åŠŸèƒ½ï¼šbase64è¯†å›¾ï¼Œkeyä¸º `image_base64`

#### v0.1.0 `2023.4.29` 
